(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d213660"],{ad07:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col text-center"},[a("q-btn",{attrs:{color:"primary"},on:{click:function(t){e.streamStarted?e.stopVideo():e.startVideo()}}},[a("q-icon",{attrs:{name:"videocam"}}),a("span",{staticClass:"q-ml-md",domProps:{textContent:e._s(e.streamStarted?"Parar WebCam":"Iniciar WebCam")}})],1),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"secondary",disabled:!e.streamStarted},on:{click:e.flipCamera}},[a("q-icon",{attrs:{name:"flip_camera_android"}}),a("span",{staticClass:"q-ml-md"},[e._v("Flip")])],1)],1)]),a("div",{staticClass:"row flex-center q-my-md"},[a("input",{attrs:{type:"range",id:"zoom-range",disabled:!e.zoomCapability},on:{input:e.updateZoom}})]),e.errorMessage?a("div",{staticClass:"row q-mx-xs"},[a("div",{staticClass:"col text-center"},[a("div",{staticClass:"inline-block bg-negative text-white q-py-sm q-px-lg rounded-borders",domProps:{textContent:e._s(e.errorMessage)}})])]):e._e(),a("div",{staticClass:"row flex-center q-mt-lg"},[a("video",{attrs:{id:"video",width:"720",height:"560",autoplay:"",muted:""},domProps:{muted:!0},on:{dblclick:e.flipCamera}})])])},s=[],o=(a("551c"),a("06db"),a("f751"),a("7f7f"),a("8993")),i=a.n(o),n=a("967e"),c=a.n(n),m=(a("96cf"),a("fa84")),l=a.n(m),u=a("c8b5"),d=a.n(u),h=a("2ef0"),p={name:"WebCam",data:function(){return{streamStarted:!1,zoomCapability:!1,rearCamera:!1,errorMessage:null,stream:null,hammer:null}},methods:{flipCamera:function(){if(this.streamStarted){if(this.rearCamera=!this.rearCamera,this.zoomCapability){var e=this.$el.querySelector("#zoom-range");e.value=this.stream.getVideoTracks()[0].getCapabilities().zoom.min,e.dispatchEvent(new Event("input"))}this.stopVideo(),this.startVideo()}},startVideo:function(){var e=l()(c.a.mark((function e(){var t,a,r,s=this;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.errorMessage=null,t=this.$el.querySelector("#video"),a={video:this.rearCamera?{facingMode:{exact:"environment"}}:{}},r=navigator.mediaDevices.getUserMedia(a),e.abrupt("return",r.then(function(){var e=l()(c.a.mark((function e(a){var r;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s.stream=a,r=s.stream.getVideoTracks()[0],t.width=r.getSettings().width,t.height=r.getSettings().height,t.srcObject=s.stream,s.streamStarted=!0,e.next=8,s.zoomCapabilities();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){switch(console.error(e,i()(e)),e.name){case"NotFoundError":case"DevicesNotFoundError":s.errorMessage="WebCam não encontrada.";break;case"NotReadableError":case"TrackStartError":s.errorMessage="WebCam já está em uso.";break;case"OverconstrainedError":case"ConstraintNotSatisfiedError":s.errorMessage="Configurações não suportadas no dispositivo.";break;case"NotAllowedError":case"PermissionDeniedError":s.errorMessage="Permissão negada pelo usuário.";break;default:s.errorMessage=" Um erro inexperado ocorreu (".concat(e.name,": ").concat(e.message,").");break}})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),stopVideo:function(){this.hammer&&(this.hammer.destroy(),this.hammer=null);var e=this.$el.querySelector("#video");this.stream&&(this.stream.getTracks().forEach((function(e){return e.stop()})),this.stream=null),e.srcObject=null,this.streamStarted=!1,this.zoomCapability=!1},zoomCapabilities:function(){var e=l()(c.a.mark((function e(){var t,a,r;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.stream.getVideoTracks()[0],e.next=3,v(1e3);case 3:if(a=t.getCapabilities(),"zoom"in a){e.next=7;break}return console.info("Zoom não é suportado por "+t.label),e.abrupt("return");case 7:this.handleZoom(),r=this.$el.querySelector("#zoom-range"),r.min=a.zoom.min,r.max=a.zoom.max,r.step=a.zoom.step,r.value=t.getSettings().zoom,this.zoomCapability=!0;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),updateZoom:function(e){var t=this.stream.getVideoTracks()[0],a=Object.assign({},t.getConstraints(),{advanced:[{zoom:e.target.value}]});t.applyConstraints(a)},handleZoom:function(){var e=this;if(!this.hammer){this.hammer=new d.a(document.body);var t=null;this.hammer.get("pinch").set({enable:!0});var a=Object(h["debounce"])((function(a){if("pinchend"!==a.type){var r=e.stream.getVideoTracks()[0].getCapabilities().zoom,s=r.min,o=r.max,i=t+t*(a.scale-1);i<s&&(i=s),i>o&&(i=o);var n=e.$el.querySelector("#zoom-range");n.value=i,n.dispatchEvent(new Event("input"))}}),50,{maxWait:50});this.hammer.on("pinchstart",(function(){var a=e.stream.getVideoTracks()[0],r=a.getSettings();"zoom"in r&&(t=1*e.$el.querySelector("#zoom-range").value)})),this.hammer.on("pinchin pinchout pinchmove",a),this.hammer.on("pinchend",(function(){t=null}))}}},beforeDestroy:function(){this.stopVideo()}};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}var f=p,g=a("2877"),b=a("eebe"),C=a.n(b),w=a("9989"),y=a("9c40"),k=a("0016"),x=Object(g["a"])(f,r,s,!1,null,null,null);t["default"]=x.exports;C()(x,"components",{QPage:w["a"],QBtn:y["a"],QIcon:k["a"]})}}]);